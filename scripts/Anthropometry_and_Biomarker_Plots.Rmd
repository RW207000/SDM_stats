---
title: "Anthropometry_and_Biomarkers_Plots"
author: "R.Welch"
date: "2025-04-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

libraries
```{r : reading libraries, include= FALSE}
packages <- c("tidyverse", "readxl", "dplyr", "magrittr", "mixtools", "emmeans", "readr","data.table", "lubridate", "ggplot2", "skimr", "ggstatsplot","summarytools", "knitr", "here", "ggthemes", "Amelia", "tidyr", "naniar", "stringr", "janitor", "ggbreak", "patchwork", "plotrix", "viridis", "hrbrthemes", "showtext")

lapply(packages, library, character.only = TRUE)
```

```{r : set up #2}
# read in data
Nov22_Nov23_minimal_dataset <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/SDM_stats/data/Nov22-Nov23.csv", header=T, na.strings= c("", "NA"))

Nov23_Nov24_minimal_dataset <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/SDM_stats/data/Nov23-Nov24.csv", header=T, na.strings= c("", "NA"))

Nov24_Feb25_minimal_dataset <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/SDM_stats/data/Feb25-Nov24.csv", header=T, na.strings= c("", "NA"))

# making Nov23-Feb25
Nov23_Feb25_minimal_dataset <- rbind(Nov23_Nov24_minimal_dataset, Nov24_Feb25_minimal_dataset)

# remove the two now individual frames
remove(Nov23_Nov24_minimal_dataset, Nov24_Feb25_minimal_dataset)

# given that stats here will often be split by sex, NK says to remove the single 'Not Assigned' (add note of this patient's data) to make plots easier to read. They're in the Nov23-Feb25 dataframe
# extract this patient's data into its own frame before removing it
NA_patient <- subset(Nov23_Feb25_minimal_dataset, Nov23_Feb25_minimal_dataset$Sex.at.birth.x == "Not Assigned")

Nov23_Feb25_minimal_dataset <- Nov23_Feb25_minimal_dataset [!Nov23_Feb25_minimal_dataset$Sex.at.birth.x == "Not Assigned",]

# colours
myColours <- c("purple", "lightblue", "grey")

# add font
font_add(family = "Arial", regular = "Arial.ttf")
```


```{r : anthro plots}
height_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "Height..cm.", "SBS", "Height 22-23")

height_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "Height..cm.", "SBS", "Height 23-25")

weight_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "Weight..kg.", "SBS", "Weight 22-23")

weight_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "Weight..kg.", "SBS", "Weight 23-25")

BMI_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "BMI", "SBS", "BMI 22-23 (overall)")

BMI_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "BMI", "None", "BMI 23-25 (overall)")
```



```{r : biomarker stats}
# need to work out SumamriseAnthro function


```

```{r : biomarker plots}
# I have manually added in the y axis breaks to condense empty space in plots

testosterone_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "Total.testosterone.value", "NTEO", "Testosterone 22-23")

testosterone_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "Total.testosterone.value", "SBS", "Testosterone 23-25")

renin_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "Renin.plasma.activity", "SBS", "Renin plasma activiy 22-23")

renin_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "Renin.plasma.activity", "SBS", "Renin plasma activiy 23-25")

OHP_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "X17.OHP.value", "SBS", "17 OHP values 22-23") + scale_y_break(c(60, 80), scale = 0.25)

OHP_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "X17.OHP.value", "SBS", "17 OHP values 23-25") + scale_y_break(c(50, 100), scale = 0.25)

andro_22_23 <- MDBoxPlot(Nov22_Nov23_minimal_dataset, "Androstenedione.value", "SBS", "Andro values 22-23") + scale_y_break(c(25, 35), scale = 0.25)

andro_23_25 <- MDBoxPlot(Nov23_Feb25_minimal_dataset, "Androstenedione.value", "SBS", "Andro values 23_25") + scale_y_break(c(25, 30, 31, 50, 51, 65, 66, 130), scale = 0.25)
```


```{r : end of script message}
print("Script complete")
```











